QUERY PARA ACTUALIZAR LOS REGISTROS DE FACTURAS CON RETENCIONES APLICADAS EN EL MISMO MES

UPDATE    SAFACT
SET              RETENIVA = X.MONTO, NOTAS9 = X.NUMEROD
FROM         SAACXC X INNER JOIN
                      SAFACT Y ON X.NumeroN = Y.NumeroD AND Y.TipoFac = 'A'
WHERE     (X.CodOper = '04-002') AND (X.TipoCxc = '81') AND (MONTH(X.FechaI) = MONTH(X.FechaR)) AND (YEAR(X.FechaI) = YEAR(X.FechaR))





QUERY QUE ISERTA REGISTROS EN SASE_RETIVACXC 



INSERT INTO SASE_RETIVACXC (NROPPAL, FECHAPAGO, NUMEROD, MONTO)
SELECT     X.nroUNICO, X.fechaI, X.NUMERON, X.monto
FROM         SAACXC X INNER JOIN
                      SAFACT Y ON X.NumeroN = Y.NumeroD AND Y.TipoFac = 'A'
WHERE     (X.CodOper = '04-002') AND (X.TipoCxc = '81') AND (MONTH(X.FechaI) <> MONTH(X.FechaR) OR YEAR(X.FechaI) <> YEAR(X.FechaR))